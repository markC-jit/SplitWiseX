module.exports=[38245,a=>{"use strict";a.s(["toFormData",()=>j]),a.i(1542);var b=a.i(68039),c=a.i(35400);let d=0,e={START_BOUNDARY:d++,HEADER_FIELD_START:d++,HEADER_FIELD:d++,HEADER_VALUE_START:d++,HEADER_VALUE:d++,HEADER_VALUE_ALMOST_DONE:d++,HEADERS_ALMOST_DONE:d++,PART_DATA_START:d++,PART_DATA:d++,END:d++},f={PART_BOUNDARY:1,LAST_BOUNDARY:2},g=a=>32|a,h=()=>{};class i{constructor(a){this.index=0,this.flags=0,this.onHeaderEnd=h,this.onHeaderField=h,this.onHeadersEnd=h,this.onHeaderValue=h,this.onPartBegin=h,this.onPartData=h,this.onPartEnd=h,this.boundaryChars={};let b=new Uint8Array((a="\r\n--"+a).length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c),this.boundaryChars[b[c]]=!0;this.boundary=b,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=e.START_BOUNDARY}write(a){let b,c,d=0,h=a.length,i=this.index,{lookbehind:j,boundary:k,boundaryChars:l,index:m,state:n,flags:o}=this,p=this.boundary.length,q=p-1,r=a.length,s=a=>{this[a+"Mark"]=d},t=a=>{delete this[a+"Mark"]},u=(a,b,c,d)=>{(void 0===b||b!==c)&&this[a](d&&d.subarray(b,c))},v=(b,c)=>{let e=b+"Mark";e in this&&(c?(u(b,this[e],d,a),delete this[e]):(u(b,this[e],a.length,a),this[e]=0))};for(d=0;d<h;d++)switch(b=a[d],n){case e.START_BOUNDARY:if(m===k.length-2){if(45===b)o|=f.LAST_BOUNDARY;else if(13!==b)return;m++;break}if(m-1==k.length-2){if(o&f.LAST_BOUNDARY&&45===b)n=e.END,o=0;else{if(o&f.LAST_BOUNDARY||10!==b)return;m=0,u("onPartBegin"),n=e.HEADER_FIELD_START}break}b!==k[m+2]&&(m=-2),b===k[m+2]&&m++;break;case e.HEADER_FIELD_START:n=e.HEADER_FIELD,s("onHeaderField"),m=0;case e.HEADER_FIELD:if(13===b){t("onHeaderField"),n=e.HEADERS_ALMOST_DONE;break}if(m++,45===b)break;if(58===b){if(1===m)return;v("onHeaderField",!0),n=e.HEADER_VALUE_START;break}if((c=g(b))<97||c>122)return;break;case e.HEADER_VALUE_START:if(32===b)break;s("onHeaderValue"),n=e.HEADER_VALUE;case e.HEADER_VALUE:13===b&&(v("onHeaderValue",!0),u("onHeaderEnd"),n=e.HEADER_VALUE_ALMOST_DONE);break;case e.HEADER_VALUE_ALMOST_DONE:if(10!==b)return;n=e.HEADER_FIELD_START;break;case e.HEADERS_ALMOST_DONE:if(10!==b)return;u("onHeadersEnd"),n=e.PART_DATA_START;break;case e.PART_DATA_START:n=e.PART_DATA,s("onPartData");case e.PART_DATA:if(i=m,0===m){for(d+=q;d<r&&!(a[d]in l);)d+=p;d-=q,b=a[d]}if(m<k.length)k[m]===b?(0===m&&v("onPartData",!0),m++):m=0;else if(m===k.length)m++,13===b?o|=f.PART_BOUNDARY:45===b?o|=f.LAST_BOUNDARY:m=0;else if(m-1===k.length)if(o&f.PART_BOUNDARY){if(m=0,10===b){o&=~f.PART_BOUNDARY,u("onPartEnd"),u("onPartBegin"),n=e.HEADER_FIELD_START;break}}else o&f.LAST_BOUNDARY&&45===b?(u("onPartEnd"),n=e.END,o=0):m=0;m>0?j[m-1]=b:i>0&&(u("onPartData",0,i,new Uint8Array(j.buffer,j.byteOffset,j.byteLength)),i=0,s("onPartData"),d--);break;case e.END:break;default:throw Error(`Unexpected state entered: ${n}`)}v("onHeaderField"),v("onHeaderValue"),v("onPartData"),this.index=m,this.state=n,this.flags=o}end(){if(this.state===e.HEADER_FIELD_START&&0===this.index||this.state===e.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==e.END)throw Error("MultipartParser.end(): stream ended unexpectedly")}}async function j(a,d){let e,f,g,h,j,k;if(!/multipart/i.test(d))throw TypeError("Failed to fetch");let l=d.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!l)throw TypeError("no or bad content-type header, no multipart boundary");let m=new i(l[1]||l[2]),n=[],o=new c.FormData,p=a=>{g+=t.decode(a,{stream:!0})},q=a=>{n.push(a)},r=()=>{let a=new b.File(n,k,{type:j});o.append(h,a)},s=()=>{o.append(h,g)},t=new TextDecoder("utf-8");for await(let b of(t.decode(),m.onPartBegin=function(){m.onPartData=p,m.onPartEnd=s,e="",f="",g="",h="",j="",k=null,n.length=0},m.onHeaderField=function(a){e+=t.decode(a,{stream:!0})},m.onHeaderValue=function(a){f+=t.decode(a,{stream:!0})},m.onHeaderEnd=function(){if(f+=t.decode(),"content-disposition"===(e=e.toLowerCase())){let a=f.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);a&&(h=a[2]||a[3]||""),(k=function(a){let b=a.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!b)return;let c=b[2]||b[3]||"",d=c.slice(c.lastIndexOf("\\")+1);return(d=d.replace(/%22/g,'"')).replace(/&#(\d{4});/g,(a,b)=>String.fromCharCode(b))}(f))&&(m.onPartData=q,m.onPartEnd=r)}else"content-type"===e&&(j=f);f="",e=""},a))m.write(b);return m.end(),o}}];

//# sourceMappingURL=9e883_node-fetch_src_utils_multipart-parser_45b1d727.js.map